# 0-2.アーキテクチャ

Vue.jsを利用したアーキテクチャ構成配下のようになります。これはあくまで一例で、今後変わるおそれもありますし、他の構成もありえます。

また、これはデプロイ周り、サーバーサイド周りのアーキテクチャは含まれていません。あくまで、1フロントプロジェクトを囲う技術スタックと思ってください。

![アーキテクチャ構成図](./%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3.png)

## ランタイム環境

### Node.js

- クライアント開発ですが、ランタイム環境の選定は重要です。
- CDNでライブラリのインストールなどはせずNPM経由でインストールします。
- 後述のviteやwebpackでビルドする必要があるため、javascriptのOSでのランタイム環境は必須です。

別案として出てきているのが、deno。複雑化しているnode_modulesを解決すべく、URLでパッケージを参照できるコーディングを実現してくれます。

一応denoのほうがインストールしたパッケージに対して、`arrow-〇〇`でアクセス制御などがかけられるため、npmパッケージへの脆弱性混入攻撃などにほんのり強いです。

が、今回は知見が少ないので、nodeにします。

## 開発フレームワーク

### Nuxt

Vue.jsの開発体験をより向上させるためのフレームワーク。SSRかSPAか、ディレクトリ構成、ルーティングなど、Vueで開発する上での面倒ごとをある程度解決してくれるフレームワークです。プロダクト全体の設定は`nuxtConfig.ts`ファイルに格納されているため、設定が分散しにくい特徴があります。

採用されないケースもあり、Vue 3対応のNuxt3は現在RFC版のため今回は採用を見送りました。

## ビルドツール

### webpack

javascript用のモジュールバンドラーで、jsだけでなく、HTML,CSS、画像などをまとめてビルドすることができます。

しかし、フロントで取り扱うアプリが大規模になればなるほどそのビルド速度は遅くなり、開発のボトルネックになってきています。

ホットモジュールリロード(HMR)機能も搭載されています。

### Vite

esbuildとrollupを用いた新しいビルドツール。Vueに限らずReactなどでも利用することができます。

HMRも差分更新のため開発規模にリロード速度が比例しにくいのが特徴です。

webpackに比べ、設定もとっつきやすいので今回はこちらを利用

### Turbopack

Nextjs13に内蔵された、Rust製の新しいビルドツール。現在、Reactのみに対応している状況だが、Vueなどにも対応予定らしい。TurbopackのVue対応版がリリースされた暁にはこちらに移行するのもありかもしれない。

Viteより速いらしい。

## Linter Formatter

インデントをそろえたりシングルクォートなのか、ダブルクォートなのかをチェックする作業は21世紀の人類の仕事ではありません。

エラーや潜在的なバグを警告するものがlinterで

コーディングスタイルを統一するのがFormatterです。

Linterは特定の言語にだけ紐づき、Formatterは広い範囲でコーディングをカバーできます。範囲が広ければ広いほど、指定できるルールが少なくなる傾向があるので、うまく使い分ける必要があります。

### ESLint

javascript専用のLinterです。

ルールやプラグインが非常に多く、理想のルール作りはとても大変ですが、一度ルールを取り決めることができれば長い期間プロジェクトに貢献してくれます。ただ、メンテされにくいものなので注意が必要です。

TypeScriptプラグイン、Nuxtプラグイン、Vueプラグイン、などがあり、適宜必要に応じて入れてく必要があります。

VisualStudioCodeの拡張と併せて使うことでファイル保存時に自動でLinterのルールに合わせ手コードを保存してくれる機能があるため、手動でのフォーマットが不要になります。

### Prettier

Vue, CSS, Javascript, TypeScript, JSX, TSX, yaml, markdown HTML, GraphQLなどに対応したコードフォーマッター。

こちらもVisualStudioCodeの拡張と合わせて使うことで、保存時に自動修正をしてくれます。

### editorConfig

すべてのファイルに対応したフォーマッター。改行コードなどプロダクト全体で揃えたいルールがある場合に有用。拡張子ごとに細かいルールもしけます。

これもVisualStudioCodeの拡張と合わせて使うことで保存時に自動修正を行えます。.NETでの開発などではこちらを採用するケースも多いです。

### ルールのバッティング

自動保存が便利だからといって、多量の拡張を一つの拡張子に当てると、お互いのルールがバッティングしあい、保存してもエラーが消えない現象が発生します。少ないFormatterとLinterで広くをカバーすることが望ましいです。
